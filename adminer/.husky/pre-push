#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸ” Running Dockerized secret scan before push..."
echo "ğŸ›¡ï¸ Checking for hardcoded tokens and secrets..."

# Run Docker security scan
docker compose run --rm security

if [ $? -ne 0 ]; then
  echo ""
  echo "âŒ SECURITY SCAN FAILED - Push blocked!"
  echo "ğŸš¨ Remove hardcoded tokens before pushing"
  echo "ğŸ“– See SECURITY.md for guidelines"
  echo "ğŸ”§ Run 'make security' to test locally"
  exit 1
fi

echo ""
echo "âœ… Security scan passed - proceeding with push"
echo "ğŸ›¡ï¸ Repository is secure"